<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://kit.fontawesome.com/39cab4bf95.js" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.slim.js" integrity="sha256-tA8y0XqiwnpwmOIl3SGAcFl2RvxHjA8qp0+1uCGmRmg=" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="assets/css/tv.css">
        <link rel="stylesheet" href="assets/css/index.css">
        <script src="assets/java/code.js"></script>
        <title>Pesquisas</title>
    </head>
    <body>
        <div class="blurEdit"></div>
        <div class="old-tv">
            <main>
                <div class="error-noise">
                    <div class="error-effect">
                        <div class="old-tv-content">
                        </div>
                        <div class="Conteudo">
                            <div class="cmdTerminal">
                                <h2 class="title" id="res">Pesquisas</h2>
                                <button class="btncdmexit"><i class="fa-solid fa-xmark"></i></button>
                                <div class="ResText" id="ResIa"></div>
                                <div class="opacity0">
                                    <input type="text" id="YourText">
                                    <button class="btnEnviar"></button>
                                </div>
                                <div class="doll">
                                    <img src="assets/DollGifs/DollStatic.gif" id="Doll">
                                </div>
                            </div>
                        </div>
                    </div>
                    <img src="assets/imagen/black.png" class="screenLoad">
                </div>
            </main>
            <div class="speaker"></div>
            <nav class="power">
                <button id="btnClickAnim"></button>
            </nav>
            <nav></nav>
            <footer></footer>
        </div>
        <img src="assets/imagen/paper.png" class="paperInfo">
        <div class="mesa"></div>
        <img src="assets/imagen/hand.png" class="handpower">
    </body>
    <script>
        //scroll
            function report(what, ammout){
                let Text = document.querySelector('#ResIa');
                if(ammout>0){
                    Text.scroll(0, (Text.scrollTop-100));
                }else{
                    Text.scroll(0, (Text.scrollTop+100));
                }
            }

            function callback(event) {
                var normalized;
                if (event.wheelDelta) {
                    normalized = (event.wheelDelta % 120 - 0) == -0 ? event.wheelDelta / 120 : event.wheelDelta / 12;
                } else {
                    var rawAmmount = event.deltaY ? event.deltaY : event.detail;
                    normalized = -(rawAmmount % 3 ? rawAmmount * 10 : rawAmmount / 3);
                }
                report('roda', normalized);
            }

            var event = 'onwheel' in document ? 'wheel' : 'onmousewheel' in document ? 'mousewheel' : 'DOMMouseScroll';
            window.addEventListener(event, callback);

        //texto
            const titulo = document.querySelector('#res');
            const time = 100;
            let textSave = '';
            let cond = [0];
            let power = 0;
            
            //key tec
            jQuery(document).bind("keyup keydown", function(e){
                if(e.ctrlKey && e.keyCode == 77){
                    let alertText = power==0? 'ligar':'desligar';
                    alert('Hora de '+alertText+' esse computador...');
                    let hand = document.querySelector('.handpower');
                    let btn = document.querySelector('#btnClickAnim');
                    let screnn = document.querySelector('.screenLoad');
                    let animationChose = power==0? 'assets/imagen/ligando.gif':'assets/imagen/desligando.gif';
                    hand.style.display = 'flex';

                    setTimeout(()=>{ 
                        btn.style.animation = 'click 1.5s ease-in-out';
                    }, 1000);
                    setTimeout(()=>{ 
                        btn.style.animation = ''; 
                        if(power==1){
                            screnn.style.display = 'flex';
                        }
                        screnn.src = animationChose;
                    }, 1500);

                    setTimeout(()=>{
                        screnn.src = 'assets/imagen/black.png';
                        hand.style.display = 'none';
                        power = power==0? 1:0;

                        let YourText = document.querySelector('#YourText');
                        let Text = document.querySelector('#ResIa');
                        if(power==1){
                            screnn.style.display = 'none';
                            YourText.focus();
                            //text inicial
                            typeWriter(Text, "* ", time);
                        }else{
                            clearText(Text);
                            clearInput(YourText);
                            YourText.blur();
                        }
                    },3000);
                }
                else if(e.keyCode==13 && power==1){
                    let btn = document.querySelector('.btnEnviar');
                    btn.click();
                }
            });

            document.querySelector('#YourText').oninput = ()=>{
                let YourText = document.querySelector('#YourText');
                let vl = YourText.value;
                let Text = document.querySelector('#ResIa');
                let space = cond[0] == 0? '':'<br><br>_____________<br><br>';

                Text.innerHTML = textSave+space+"* " + vl;
            };

            document.querySelector('.btnEnviar').addEventListener('click', handleClick());

            document.querySelector('body').addEventListener('click', ()=>{
                let YourText = document.querySelector('#YourText');
                if(power==1){
                    YourText.focus();
                    let btn = document.querySelector('.btnEnviar');
                    btn.addEventListener('click', handleClick);
                }
            });

            function handleClick(){
                this.removeEventListener('click', handleClick);
                let anim = document.querySelector('#Doll');
                anim.src = 'assets/DollGifs/DollTallk.gif';
                $('#YourText').attr('disabled', 'disabled');
                let YourText = document.querySelector('#YourText');
                let vl = YourText.value;
                let Text = document.querySelector('#ResIa');
                cond[0] = 1;
                
                Text.innerHTML +='<br><br>_____________<br><br>BOT_Jotaro > ';
                typeWriter(Text, vl, time);
                clearInput(YourText);
                alert(vl);
                let textArray = vl.split('');
                setTimeout(() => {
                    alert('tempo passou');
                    anim.src = 'assets/DollGifs/DollStatic.gif';
                    $('#YourText').removeAttr('disabled');
                    let bodie = document.querySelector('body');
                    bodie.click();
                    textSave = Text.innerHTML;
                }, (time * vl.length));
            }
    </script>
</html>